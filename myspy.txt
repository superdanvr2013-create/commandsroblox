-- Создаем простое текстовое окно для визуального отслеживания
local screenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
local textBox = Instance.new("TextBox", screenGui)
textBox.Size = UDim2.new(0, 400, 0, 100)
textBox.Position = UDim2.new(0, 10, 0, 10)
textBox.TextScaled = true
textBox.BackgroundColor3 = Color3.new(0,0,0)
textBox.TextColor3 = Color3.new(0,1,0)
textBox.Text = "Ожидание данных..."
textBox.ClearTextOnFocus = false
textBox.TextXAlignment = Enum.TextXAlignment.Left

local function logData(remote, method, args)
    local path = remote:GetFullName()
    local argString = ""
    
    -- Превращаем таблицу аргументов в строку
    for i, v in pairs(args) do
        argString = argString .. tostring(v) .. (i < #args and ", " or "")
    end

    local finalLog = string.format("[%s] %s | Путь: %s | Данные: {%s}", os.date("%X"), method, path, argString)
    
    -- Вывод в консоль (F9)
    print(finalLog)
    
    -- Вывод в визуальное окно
    textBox.Text = "ПОСЛЕДНИЙ ВЫЗОВ:\n" .. finalLog
end

-- Хук через __namecall
local oldNamecall
oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
    local method = getnamecallmethod()
    local args = {...}

    if method == "FireServer" or method == "InvokeServer" then
        task.spawn(function() logData(self, method, args) end)
    end

    return oldNamecall(self, ...)
end)

-- Прямой хук функций (на случай если namecall не сработает)
local oldFire = hookfunction(Instance.new("RemoteEvent").FireServer, function(self, ...)
    task.spawn(function() logData(self, "FireServer", {...}) end)
    return oldFire(self, ...)
end)

print("--- Шпион для Xeno запущен! ---")
